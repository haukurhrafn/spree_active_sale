<%= render partial: 'spree/shared/error_messages', locals: { target: @active_sale } %>

<%= form_for [:admin, @active_sale] do |f| %>

  <fieldset data-hook="new_active_sale" class="no-border-top">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h1 class="panel-title">
          <%= Spree.t(:list, scope: [:active_sale, :title]) %>
        </h1>
      </div>

      <div class="panel-body">

        <div class='row'>
          <div class="col-md-6">
            <%= f.field_container :name, class: ['form-group'] do %>
              <%= f.label :name, Spree.t(:name) %> <span class="required">*</span><br />
              <%= f.text_field :name, class: 'form-control' %>
              <%= f.error_message_on :name %>
            <% end %>
          </div>

          <div class="col-md-6">
            <% unless @active_sale.new_record? %>
              <%= f.field_container :permalink, class: ['form-group'] do %>
                <%= f.label :permalink, raw(Spree.t(:permalink)) %> <span class="required">*</span><br />
                <%= f.text_field :permalink, class: 'form-control' %>
                <%= f.error_message_on :permalink %>
              <% end %>
            <% end %>
          </div>
          <div class="clear"></div>
        </div>

        <p class="form-buttons" data-hook="admin_active_sale_form_buttons">
          <% if @active_sale.new_record? %>
            <%= render partial: 'spree/admin/shared/new_resource_links' %>
          <% else %>
            <%= render partial: 'spree/admin/shared/edit_resource_links' %>
          <% end %>
        </p>
      </div>
    </div>
  </fieldset>
<% end %>

<% unless @active_sale.new_record? %>
  <div class="panel panel-default">
    <% if @active_sale.active_sale_events.blank? %>
      <% @active_sale_event = @active_sale.active_sale_events.build(name: @active_sale.name) %>
        <div class="panel-heading">
          <h1 class="panel-title">
            <%= Spree.t(:create_if_no_record, scope: [:active_sale, :event]) %>
          </h1>
        </div>

        <%= render partial: "spree/admin/active_sale_events/form", locals: { events: @active_sale_event } %>
    <% else %>
      <% @active_sale_events = @active_sale.active_sale_events %>
      <%= render partial: "spree/admin/shared/list_events", locals: { events: @active_sale_events } %>
    <% end %>
  </div>
<% end %>
